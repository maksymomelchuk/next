(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[293],{3673:function(e,t,o){Promise.resolve().then(o.bind(o,1098))},7275:function(e,t,o){"use strict";let r;o.d(t,{Vo:function(){return u},tP:function(){return r}});var n=o(5607),s=o(8570),a=o(2943),i=o(8821),c=o(1821);let l={onLoad:"login-required",pkceMethod:"S256"};r=new i.Z({realm:"LDB-DEV",clientId:"ldb-front",url:"https://2933-91-214-85-180.ngrok-free.app"});let u=(0,s.createContext)({isAuthenticated:!1,logout:()=>{},firstName:"",token:"",profile:null,permissions:null,roles:null,userType:""});t.ZP=e=>{console.log("rendering AuthContextProvider");let[t,o]=(0,s.useState)(!1),[i,d]=(0,s.useState)(""),[p,f]=(0,s.useState)(null),[g,h]=(0,s.useState)(""),[S,m]=(0,s.useState)(null),[T,y]=(0,s.useState)(null),[k,O]=(0,s.useState)("");return(0,a.a)({queryKey:["profile"],queryFn:c.YI,enabled:t,onSuccess:e=>{f(e),h(e.first_name),m(e.permissions),y(e.roles),O(e.type.toLowerCase())}}),(0,s.useEffect)(()=>{(async function(){console.log("initialize Keycloak");try{let e=await r.init(l);console.log("isAuthenticatedResponse:",e),e||(console.log("user is not yet authenticated. forwarding user to login."),r.login());let t=r.token,n=r.refreshToken;t&&n&&(d(t),localStorage.setItem("token",t),localStorage.setItem("refreshToken",n)),console.log("user already authenticated"),o(e)}catch(e){console.log("error initializing Keycloak"),o(!1)}})().then(()=>console.log("initialized Keycloak")).catch(()=>console.log("error initializing Keycloak"))},[]),(0,n.jsx)(u.Provider,{value:{isAuthenticated:t,logout:()=>{r.logout(),localStorage.removeItem("token"),localStorage.removeItem("refreshToken")},firstName:g,token:i,profile:p,permissions:S,roles:T,userType:k},children:t?e.children:null})}},1821:function(e,t,o){"use strict";o.d(t,{N4:function(){return a},O8:function(){return s},YI:function(){return n}});var r=o(5125);let n=async()=>{let{data:e}=await r.ZP.get("/account");return e},s=async e=>{let{data:t}=await r.ZP.put("/account/update",e);return t},a=async e=>{let{data:t}=await r.ZP.put("/account/update-password",e);return t}},5125:function(e,t,o){"use strict";o.d(t,{ZP:function(){return i}});var r=o(5083),n=o(7275),s=e=>{let t=new URLSearchParams({client_id:"ldb-front",grant_type:"refresh_token",refresh_token:e}),o=r.Z.post("".concat("https://2933-91-214-85-180.ngrok-free.app","/realms/").concat("LDB-DEV","/protocol/openid-connect/token"),t.toString(),{headers:{"Content-Type":"application/x-www-form-urlencoded"}});return o};let a=r.Z.create({baseURL:"https://2f03-91-214-85-180.ngrok-free.app/api/v1",headers:{}});a.interceptors.request.use(e=>(e.headers&&e.headers.set("Authorization","Bearer ".concat(localStorage.getItem("token"))),e)),a.interceptors.response.use(function(e){return e},async function(e){let t=e.config;if(console.log("Some error in request",e),419===e.response.status&&!t._retry){console.log("Trying to refresh token",e),t._retry=!0;let i=localStorage.getItem("refreshToken");if(!i){console.log("NO TOKEN IN LOCAL STORAGE --> FORCE LOGOUT"),n.tP.logout();return}try{let e=await s(i),o=e.data.access_token,r=e.data.refresh_token;return localStorage.setItem("token",o),localStorage.setItem("refreshToken",r),t.headers.Authorization="Bearer ".concat(o),a(t)}catch(e){if(r.Z.isAxiosError(e)){var o;console.log("file: axiosInstance.ts:59 ~ error:",e),(null===(o=e.response)||void 0===o?void 0:o.status)===400&&"invalid_grant"===e.response.data.error&&(console.log("NO TOKEN --> FORCE LOGOUT"),localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),n.tP.logout())}}}return Promise.reject(e)});var i={get:(e,t)=>a.get(e,t),delete:(e,t)=>a.delete(e,t),post:(e,t,o)=>a.post(e,t,o),patch:(e,t,o)=>a.patch(e,t,o),put:(e,t,o)=>a.put(e,t,o)}},1098:function(e,t,o){"use strict";o.r(t);var r=o(5607);o(8570);var n=o(4889);t.default=()=>((0,n.b)("Soi@ListImports"),(0,r.jsx)("section",{className:"container grid items-center gap-6 pb-8 pt-6 md:py-10",children:(0,r.jsx)("div",{children:"SOI Records History page"})}))},5697:function(e,t,o){"use strict";o.d(t,{Am:function(){return d},pm:function(){return p}});var r=o(8570);let n=0,s=new Map,a=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),u({type:"REMOVE_TOAST",toastId:e})},5e3);s.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,3)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:o}=t;return o?a(o):e.toasts.forEach(e=>{a(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===o||void 0===o?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},c=[],l={toasts:[]};function u(e){l=i(l,e),c.forEach(e=>{e(l)})}function d(e){let{...t}=e,o=(n=(n+1)%Number.MAX_VALUE).toString(),r=()=>u({type:"DISMISS_TOAST",toastId:o});return u({type:"ADD_TOAST",toast:{...t,id:o,open:!0,onOpenChange:e=>{e||r()}}}),{id:o,dismiss:r,update:e=>u({type:"UPDATE_TOAST",toast:{...e,id:o}})}}function p(){let[e,t]=r.useState(l);return r.useEffect(()=>(c.push(t),()=>{let e=c.indexOf(t);e>-1&&c.splice(e,1)}),[e]),{...e,toast:d,dismiss:e=>u({type:"DISMISS_TOAST",toastId:e})}}},4889:function(e,t,o){"use strict";o.d(t,{b:function(){return i}});var r=o(8570),n=o(9520),s=o(7275),a=o(5697);let i=e=>{let[t,o]=(0,r.useState)(!1),{permissions:i}=(0,r.useContext)(s.Vo);return(0,r.useEffect)(()=>{i&&(i.includes(e)?o(!0):((0,a.Am)({variant:"error",description:"You do not have permission to access this page."}),(0,n.redirect)("/")))},[i,e]),t}},9520:function(e,t,o){e.exports=o(5202)}},function(e){e.O(0,[468,501,524,744],function(){return e(e.s=3673)}),_N_E=e.O()}]);