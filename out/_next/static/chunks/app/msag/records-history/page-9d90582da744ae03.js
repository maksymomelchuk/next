(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[898],{2795:function(e,t,r){Promise.resolve().then(r.bind(r,8421))},7275:function(e,t,r){"use strict";let o;r.d(t,{Vo:function(){return l},tP:function(){return o}});var n=r(5607),s=r(8570),a=r(2943),i=r(8821),c=r(1821);let u={onLoad:"login-required",pkceMethod:"S256"};o=new i.Z({realm:"LDB-DEV",clientId:"ldb-front",url:"https://2933-91-214-85-180.ngrok-free.app"});let l=(0,s.createContext)({isAuthenticated:!1,logout:()=>{},firstName:"",token:"",profile:null,permissions:null,roles:null,userType:""});t.ZP=e=>{console.log("rendering AuthContextProvider");let[t,r]=(0,s.useState)(!1),[i,d]=(0,s.useState)(""),[p,f]=(0,s.useState)(null),[g,m]=(0,s.useState)(""),[h,y]=(0,s.useState)(null),[S,z]=(0,s.useState)(null),[_,T]=(0,s.useState)("");return(0,a.a)({queryKey:["profile"],queryFn:c.YI,enabled:t,onSuccess:e=>{f(e),m(e.first_name),y(e.permissions),z(e.roles),T(e.type.toLowerCase())}}),(0,s.useEffect)(()=>{(async function(){console.log("initialize Keycloak");try{let e=await o.init(u);console.log("isAuthenticatedResponse:",e),e||(console.log("user is not yet authenticated. forwarding user to login."),o.login());let t=o.token,n=o.refreshToken;t&&n&&(d(t),localStorage.setItem("token",t),localStorage.setItem("refreshToken",n)),console.log("user already authenticated"),r(e)}catch(e){console.log("error initializing Keycloak"),r(!1)}})().then(()=>console.log("initialized Keycloak")).catch(()=>console.log("error initializing Keycloak"))},[]),(0,n.jsx)(l.Provider,{value:{isAuthenticated:t,logout:()=>{o.logout(),localStorage.removeItem("token"),localStorage.removeItem("refreshToken")},firstName:g,token:i,profile:p,permissions:h,roles:S,userType:_},children:t?e.children:null})}},1821:function(e,t,r){"use strict";r.d(t,{N4:function(){return a},O8:function(){return s},YI:function(){return n}});var o=r(5125);let n=async()=>{let{data:e}=await o.ZP.get("/account");return e},s=async e=>{let{data:t}=await o.ZP.put("/account/update",e);return t},a=async e=>{let{data:t}=await o.ZP.put("/account/update-password",e);return t}},5125:function(e,t,r){"use strict";r.d(t,{ZP:function(){return i}});var o=r(5083),n=r(7275),s=e=>{let t=new URLSearchParams({client_id:"ldb-front",grant_type:"refresh_token",refresh_token:e}),r=o.Z.post("".concat("https://2933-91-214-85-180.ngrok-free.app","/realms/").concat("LDB-DEV","/protocol/openid-connect/token"),t.toString(),{headers:{"Content-Type":"application/x-www-form-urlencoded"}});return r};let a=o.Z.create({baseURL:"https://2f03-91-214-85-180.ngrok-free.app/api/v1",headers:{}});a.interceptors.request.use(e=>(e.headers&&e.headers.set("Authorization","Bearer ".concat(localStorage.getItem("token"))),e)),a.interceptors.response.use(function(e){return e},async function(e){let t=e.config;if(console.log("Some error in request",e),419===e.response.status&&!t._retry){console.log("Trying to refresh token",e),t._retry=!0;let i=localStorage.getItem("refreshToken");if(!i){console.log("NO TOKEN IN LOCAL STORAGE --> FORCE LOGOUT"),n.tP.logout();return}try{let e=await s(i),r=e.data.access_token,o=e.data.refresh_token;return localStorage.setItem("token",r),localStorage.setItem("refreshToken",o),t.headers.Authorization="Bearer ".concat(r),a(t)}catch(e){if(o.Z.isAxiosError(e)){var r;console.log("file: axiosInstance.ts:59 ~ error:",e),(null===(r=e.response)||void 0===r?void 0:r.status)===400&&"invalid_grant"===e.response.data.error&&(console.log("NO TOKEN --> FORCE LOGOUT"),localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),n.tP.logout())}}}return Promise.reject(e)});var i={get:(e,t)=>a.get(e,t),delete:(e,t)=>a.delete(e,t),post:(e,t,r)=>a.post(e,t,r),patch:(e,t,r)=>a.patch(e,t,r),put:(e,t,r)=>a.put(e,t,r)}},8238:function(e,t,r){"use strict";r.d(t,{V9:function(){return u},Pn:function(){return l},pp:function(){return d}});var o=r(2943),n=r(5125),s=r(6028);let a=s.z.object({version:s.z.string()}),i=s.z.object({created_at:s.z.string(),error:s.z.union([a,s.z.array(s.z.any())]),file:s.z.string(),file_version:s.z.number(),header:s.z.array(s.z.any()),id:s.z.number(),modified:s.z.number(),modified_human:s.z.string(),nena_version:s.z.string(),parsed_at:s.z.union([s.z.number(),s.z.null()]),size:s.z.number(),size_human:s.z.string(),status_id:s.z.number(),total_error_records:s.z.number(),total_records:s.z.number(),total_valid_records:s.z.number(),trailer:s.z.array(s.z.any()),updated_at:s.z.union([s.z.string(),s.z.null()])}),c=s.z.array(i),u=async(e,t,r)=>{let{data:o}=await n.ZP.get("/msag/imports".concat(r,"&limit=").concat(e,"&offset=").concat(t)),s=c.parse(o);return s},l=async e=>{let{id:t,data:r}=e,o=await n.ZP.put("/sdp/".concat(t),r);return console.log("Data after updating msag imports",o),o},d=()=>(0,o.a)({queryKey:["msag-records-history"],queryFn:async()=>{let{data:e}=await n.ZP.get("/msag/records/history");return console.log("All msag records history:",e),e}})},8421:function(e,t,r){"use strict";r.r(t);var o=r(5607);r(8570);var n=r(8238),s=r(4889);t.default=()=>{(0,s.b)("Msag@ListRecordsHistory");let{data:e}=(0,n.pp)();return(0,o.jsxs)("section",{className:"container grid items-center gap-6 pb-8 pt-6 md:py-10",children:[(0,o.jsx)("div",{children:"MSAG Records History page"}),(0,o.jsx)("div",{children:JSON.stringify(e)})]})}},5697:function(e,t,r){"use strict";r.d(t,{Am:function(){return d},pm:function(){return p}});var o=r(8570);let n=0,s=new Map,a=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),l({type:"REMOVE_TOAST",toastId:e})},5e3);s.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,3)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?a(r):e.toasts.forEach(e=>{a(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},c=[],u={toasts:[]};function l(e){u=i(u,e),c.forEach(e=>{e(u)})}function d(e){let{...t}=e,r=(n=(n+1)%Number.MAX_VALUE).toString(),o=()=>l({type:"DISMISS_TOAST",toastId:r});return l({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||o()}}}),{id:r,dismiss:o,update:e=>l({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function p(){let[e,t]=o.useState(u);return o.useEffect(()=>(c.push(t),()=>{let e=c.indexOf(t);e>-1&&c.splice(e,1)}),[e]),{...e,toast:d,dismiss:e=>l({type:"DISMISS_TOAST",toastId:e})}}},4889:function(e,t,r){"use strict";r.d(t,{b:function(){return i}});var o=r(8570),n=r(9520),s=r(7275),a=r(5697);let i=e=>{let[t,r]=(0,o.useState)(!1),{permissions:i}=(0,o.useContext)(s.Vo);return(0,o.useEffect)(()=>{i&&(i.includes(e)?r(!0):((0,a.Am)({variant:"error",description:"You do not have permission to access this page."}),(0,n.redirect)("/")))},[i,e]),t}},9520:function(e,t,r){e.exports=r(5202)}},function(e){e.O(0,[468,28,501,524,744],function(){return e(e.s=2795)}),_N_E=e.O()}]);