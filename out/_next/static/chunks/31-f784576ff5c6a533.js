"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[31],{7275:function(e,t,r){let n;r.d(t,{Vo:function(){return c},tP:function(){return n}});var o=r(5607),a=r(8570),s=r(2943),i=r(8821),l=r(1821);let u={onLoad:"login-required",pkceMethod:"S256"};n=new i.Z({realm:"LDB-DEV",clientId:"ldb-front",url:"https://2933-91-214-85-180.ngrok-free.app"});let c=(0,a.createContext)({isAuthenticated:!1,logout:()=>{},firstName:"",token:"",profile:null,permissions:null,roles:null,userType:""});t.ZP=e=>{console.log("rendering AuthContextProvider");let[t,r]=(0,a.useState)(!1),[i,d]=(0,a.useState)(""),[f,m]=(0,a.useState)(null),[g,p]=(0,a.useState)(""),[h,v]=(0,a.useState)(null),[y,b]=(0,a.useState)(null),[x,S]=(0,a.useState)("");return(0,s.a)({queryKey:["profile"],queryFn:l.YI,enabled:t,onSuccess:e=>{m(e),p(e.first_name),v(e.permissions),b(e.roles),S(e.type.toLowerCase())}}),(0,a.useEffect)(()=>{(async function(){console.log("initialize Keycloak");try{let e=await n.init(u);console.log("isAuthenticatedResponse:",e),e||(console.log("user is not yet authenticated. forwarding user to login."),n.login());let t=n.token,o=n.refreshToken;t&&o&&(d(t),localStorage.setItem("token",t),localStorage.setItem("refreshToken",o)),console.log("user already authenticated"),r(e)}catch(e){console.log("error initializing Keycloak"),r(!1)}})().then(()=>console.log("initialized Keycloak")).catch(()=>console.log("error initializing Keycloak"))},[]),(0,o.jsx)(c.Provider,{value:{isAuthenticated:t,logout:()=>{n.logout(),localStorage.removeItem("token"),localStorage.removeItem("refreshToken")},firstName:g,token:i,profile:f,permissions:h,roles:y,userType:x},children:t?e.children:null})}},1821:function(e,t,r){r.d(t,{N4:function(){return s},O8:function(){return a},YI:function(){return o}});var n=r(5125);let o=async()=>{let{data:e}=await n.ZP.get("/account");return e},a=async e=>{let{data:t}=await n.ZP.put("/account/update",e);return t},s=async e=>{let{data:t}=await n.ZP.put("/account/update-password",e);return t}},5125:function(e,t,r){r.d(t,{ZP:function(){return i}});var n=r(5083),o=r(7275),a=e=>{let t=new URLSearchParams({client_id:"ldb-front",grant_type:"refresh_token",refresh_token:e}),r=n.Z.post("".concat("https://2933-91-214-85-180.ngrok-free.app","/realms/").concat("LDB-DEV","/protocol/openid-connect/token"),t.toString(),{headers:{"Content-Type":"application/x-www-form-urlencoded"}});return r};let s=n.Z.create({baseURL:"https://2f03-91-214-85-180.ngrok-free.app/api/v1",headers:{}});s.interceptors.request.use(e=>(e.headers&&e.headers.set("Authorization","Bearer ".concat(localStorage.getItem("token"))),e)),s.interceptors.response.use(function(e){return e},async function(e){let t=e.config;if(console.log("Some error in request",e),419===e.response.status&&!t._retry){console.log("Trying to refresh token",e),t._retry=!0;let i=localStorage.getItem("refreshToken");if(!i){console.log("NO TOKEN IN LOCAL STORAGE --> FORCE LOGOUT"),o.tP.logout();return}try{let e=await a(i),r=e.data.access_token,n=e.data.refresh_token;return localStorage.setItem("token",r),localStorage.setItem("refreshToken",n),t.headers.Authorization="Bearer ".concat(r),s(t)}catch(e){if(n.Z.isAxiosError(e)){var r;console.log("file: axiosInstance.ts:59 ~ error:",e),(null===(r=e.response)||void 0===r?void 0:r.status)===400&&"invalid_grant"===e.response.data.error&&(console.log("NO TOKEN --> FORCE LOGOUT"),localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),o.tP.logout())}}}return Promise.reject(e)});var i={get:(e,t)=>s.get(e,t),delete:(e,t)=>s.delete(e,t),post:(e,t,r)=>s.post(e,t,r),patch:(e,t,r)=>s.patch(e,t,r),put:(e,t,r)=>s.put(e,t,r)}},3782:function(e,t,r){r.d(t,{d:function(){return l},z:function(){return u}});var n=r(5607),o=r(8570),a=r(302),s=r(1835),i=r(9958);let l=(0,s.j)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-muted hover:text-accent-foreground",outlineNav:"border border-white hover:scale-105 hover:bg-accent",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-secondary hover:text-secondary-foreground",ghostThemeToggle:"hover:bg-accent hover:text-background dark:hover:bg-background dark:hover:text-foreground",link:"underline-offset-4 hover:underline text-primary"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),u=o.forwardRef((e,t)=>{let{className:r,variant:o,size:s,asChild:u=!1,...c}=e,d=u?a.g7:"button";return(0,n.jsx)(d,{className:(0,i.cn)(l({variant:o,size:s,className:r})),ref:t,...c})});u.displayName="Button"},4614:function(e,t,r){r.d(t,{l0:function(){return f},NI:function(){return b},pf:function(){return x},Wi:function(){return g},xJ:function(){return v},lX:function(){return y},zG:function(){return S}});var n=r(5607),o=r(8570),a=r(302),s=r(6048),i=r(9958),l=r(3592),u=r(1835);let c=(0,u.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)(l.f,{ref:t,className:(0,i.cn)(c(),r),...o})});d.displayName=l.f.displayName;let f=s.RV,m=o.createContext({}),g=e=>{let{...t}=e;return(0,n.jsx)(m.Provider,{value:{name:t.name},children:(0,n.jsx)(s.Qr,{...t})})},p=()=>{let e=o.useContext(m),t=o.useContext(h),{getFieldState:r,formState:n}=(0,s.Gc)(),a=r(e.name,n);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=t;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...a}},h=o.createContext({}),v=o.forwardRef((e,t)=>{let{className:r,...a}=e,s=o.useId();return(0,n.jsx)(h.Provider,{value:{id:s},children:(0,n.jsx)("div",{ref:t,className:(0,i.cn)("space-y-2",r),...a})})});v.displayName="FormItem";let y=o.forwardRef((e,t)=>{let{className:r,...o}=e,{error:a,formItemId:s}=p();return(0,n.jsx)(d,{ref:t,className:(0,i.cn)(a&&"text-accent",r),htmlFor:s,...o})});y.displayName="FormLabel";let b=o.forwardRef((e,t)=>{let{...r}=e,{error:o,formItemId:s,formDescriptionId:i,formMessageId:l}=p();return(0,n.jsx)(a.g7,{ref:t,id:s,"aria-describedby":o?"".concat(i," ").concat(l):"".concat(i),"aria-invalid":!!o,...r})});b.displayName="FormControl";let x=o.forwardRef((e,t)=>{let{className:r,...o}=e,{formDescriptionId:a}=p();return(0,n.jsx)("p",{ref:t,id:a,className:(0,i.cn)("text-muted-foreground text-sm",r),...o})});x.displayName="FormDescription";let S=o.forwardRef((e,t)=>{let{className:r,children:o,...a}=e,{error:s,formMessageId:l}=p(),u=s?String(null==s?void 0:s.message):o;return u?(0,n.jsx)("p",{ref:t,id:l,className:(0,i.cn)("text-accent text-sm font-medium",r),...a,children:u}):null});S.displayName="FormMessage"},5175:function(e,t,r){r.d(t,{I:function(){return s}});var n=r(5607),o=r(8570),a=r(9958);let s=o.forwardRef((e,t)=>{let{className:r,type:o,...s}=e;return(0,n.jsx)("input",{type:o,className:(0,a.cn)("border-input ring-offset-background placeholder:text-muted-foreground focus-visible:ring-ring flex h-10 w-full rounded-md border bg-transparent px-3 py-2 text-sm file:border-0 file:bg-transparent file:text-sm file:font-medium focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...s})});s.displayName="Input"},1189:function(e,t,r){r.d(t,{SP:function(){return u},dr:function(){return l},mQ:function(){return i},nU:function(){return c}});var n=r(5607),o=r(8570),a=r(3470),s=r(9958);let i=a.fC,l=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)(a.aV,{ref:t,className:(0,s.cn)("bg-muted text-muted-foreground inline-flex h-9 items-center justify-center rounded-lg p-1",r),...o})});l.displayName=a.aV.displayName;let u=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)(a.xz,{ref:t,className:(0,s.cn)("ring-offset-background focus-visible:ring-ring data-[state=active]:bg-background data-[state=active]:text-foreground inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow",r),...o})});u.displayName=a.xz.displayName;let c=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)(a.VY,{ref:t,className:(0,s.cn)("ring-offset-background focus-visible:ring-ring mt-2 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2",r),...o})});c.displayName=a.VY.displayName},5697:function(e,t,r){r.d(t,{Am:function(){return d},pm:function(){return f}});var n=r(8570);let o=0,a=new Map,s=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),c({type:"REMOVE_TOAST",toastId:e})},5e3);a.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,3)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?s(r):e.toasts.forEach(e=>{s(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],u={toasts:[]};function c(e){u=i(u,e),l.forEach(e=>{e(u)})}function d(e){let{...t}=e,r=(o=(o+1)%Number.MAX_VALUE).toString(),n=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||n()}}}),{id:r,dismiss:n,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=n.useState(u);return n.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:d,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9958:function(e,t,r){r.d(t,{cn:function(){return a}});var n=r(9754),o=r(4663);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.m)((0,n.W)(t))}}}]);